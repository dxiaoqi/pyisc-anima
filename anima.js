"use strict";function Vector2(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(this instanceof Vector2))return new Vector2(t,o);this.x=t,this.y=o}function motion(t,o){Vector2.call(this,t,o)}function Fouce(t,o){Vector2.call(this,t,o)}function Sprite(t){util.depthClone(t,this),this.pos=new Vector2(t.pro.x,t.pro.y),this.v=new motion(t.pro.vx,t.pro.vy),this.m=t.pro.m?t.pro.m:1,this.Fouce=new Vector2(0,.01),this.rotation=0,this.Fun=[t.draw,t.logic],this.logic=t.logic?t.logic:new Function,this.easing=.1,this.timer=0,this.state="PENDDING",this.moveList=[],this.move_site=null}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},world={horz:0,g:new Vector2(0,.01)},_global={offsetCanvas:null},util={depthClone:function(t,o){for(var e in t)"object"==_typeof(t[e])?(o[e]="array"==t[e].constructor?[]:{},this.depthClone(t[e],o[e])):o[e]=t[e]},inherits:function(t,o){var e=function(){};e.prototype=o.prototype,t.prototype=new e,t.prototype.constructor=t},offsetCanvas:function(t){_global.offscreenCanvas=document.createElement("canvas"),_global.offscreenContext=_global.offscreenCanvas.getContext("2d"),_global.offscreenCanvas.width=t.canvas.width,_global.offscreenCanvas.height=t.canvas.height},timer:function(){var t=0;return function(){return t++}}},Tweens={Linear:function(t,o,e,n){return e*t/n+o},easeIn:function(t,o,e,n){return e*(t/=n)*t+o},easeOut:function(t,o,e,n){return-e*(t/=n)*(t-2)+o},easeInOut:function(t,o,e,n){return(t/=n/2)<1?e/2*t*t+o:-e/2*(--t*(t-2)-1)+o}},FouceType={tanli:function(t,o,e){retrun(o.x)},hengli:function(t){return t}};Vector2.prototype.copy=function(t){return new Vector2(this.x,this.y)},Vector2.prototype.length=function(t){return Math.sqrt(this.x*this.x+this.y*this.y)},Vector2.prototype.normalize=function(t){var o=1/this.length();return new Vector2(this.x*o,this.y*o)},Vector2.prototype.negate=function(t){return new Vector2(-this.x,-this.y)},Vector2.prototype.add=function(t){this.x+=t.x,this.y+=t.y},Vector2.prototype.subtract=function(t){return new Vector2(t.x-this.x,t.y-this.y)},Vector2.prototype.multiply=function(t){return this.x,this.y,this},Vector2.prototype.divide=function(t){var o=1/t;return new Vector2(this.x*o,this.y*o)},Vector2.prototype.dot=function(t){return this.x*t.x+this.y*t.y},Vector2.prototype.move=function(t){return this.x=t.x,this.y=t.y,this},Vector2.prototype.rotate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=t/180*Math.PI;this.x1=this.x*Math.cos(o)-this.y*Math.sin(o),this.y1=this.x*Math.sin(o)+this.y*Math.cos(o)};var _pro=[motion,Fouce];_pro.forEach(function(t,o){util.inherits(t,Vector2)}),motion.prototype.uniformspeed=function(t){t.x&&t.y&&(t.x+=this.x,t.y+=this.y)},motion.prototype.changespeed=function(t,o){this.x+=o.x,this.y+=o.y,this.uniformspeed(t)},motion.prototype.addFouceAppend=function(t,o,e){t.constructor==Vector2?(this.a=o?t.multiply(1/o):console.log("obj do not have m"),this.changespeed(e,this.a)):console.log("请输入正常数据")},Sprite.prototype.moveTo=function(t,o,e){var n=(this.pos.subtract(t),this);null==n.move_site&&(n.move_site=n.pos),Math.abs(Math.floor(n.pos.x-t.x))<=1?(n.state="PENDDING",n.v.x=0,n.v.y=0):n.state="MOVING",Tweens[e]&&"MOVING"==n.state&&(n.v.x=.01*Tweens[e](n.timer,n.move_site.x,t.x,o),n.v.y=.01*Tweens[e](n.timer,n.move_site.y,t.y,o),n.v.uniformspeed(n.pos),n.timer==o?(n.timer=0,n.move_site=null):n.timer+=1)},Sprite.prototype.move=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.v.changespeed(this.pos,t)},Sprite.prototype.init=function(t){var t=t;t||(_global.context?t=_global.context:console.error("can not get context of canvas")),_global.offscreenContext||util.offsetCanvas(t);var o=this;_global.offscreenContext.save(),_global.offscreenContext.translate(this.pos.x,this.pos.y),_global.offscreenContext.rotate(this.rotation),o.v.addFouceAppend(o.Fouce,o.m,o.pos),o.Fun[0].call(this,_global.offscreenContext),_global.offscreenContext.restore(),_global.context.drawImage(_global.offscreenCanvas,0,0,_global.offscreenCanvas.width,_global.offscreenCanvas.height),_global.offscreenContext.clearRect(0,0,_global.offscreenCanvas.width,_global.offscreenCanvas.height)},Sprite.prototype.raotate=function(t){this.rotation=t},Sprite.prototype.addFouce=function(t,o){var e=this,n=new Vector2(t.x,t.y);switch(o){case"shunjian":var r=n.multiply(1/e.m);this.v.add(r);break;default:e.Fouce.add(n)}},Sprite.prototype.IK=function(t,o){},Sprite.prototype.FK=function(t,o){};